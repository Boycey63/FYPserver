{"version":3,"sources":["../../src/models/dbUpdate.js"],"names":["express","require","mysql","router","Router","pool","createPool","host","user","password","database","post","req","res","username","body","email","passwrd","phoneNum","city","gender","DOB","userType","userID","secretkey","getConnection","err","connection","query","json","release","companyID","companyName","ownerName","yearEst","companyNum","companyEmail","description","address","latitude","longitude","monday","tuesday","wednesday","thursday","friday","saturday","sunday","console","log","module","exports"],"mappings":"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","file":"dbUpdate.js","sourcesContent":["const express = require('express');\nconst mysql = require('mysql');\nconst router = express.Router();\n\n\nlet pool = mysql.createPool({\n    host: '127.0.0.1',\n    user: 'root',\n    password: 'TLGjb18!',\n    database: 'LittleGuys1'\n});\n\nrouter.post('/UserDetail', function(req, res) {\n    let username = req.body.username;\n    let email = req.body.email;\n    let passwrd = req.body.passwrd;\n    let phoneNum = req.body.phoneNum;\n    let city = req.body.city;\n    let gender = req.body.gender;\n    let DOB = req.body.DOB;\n    let userType = req.body.userType;\n    let userID = req.body.userID;\n    let secretkey = 'secretkey123';\n\n    pool.getConnection(function(err, connection) {\n        connection.query(\"UPDATE Users SET username = ?, email = ?, passwrd = AES_ENCRYPT(? ,?), phoneNum = ?, city = ?, gender = ?, DOB = ?, userType = ? WHERE userID = ?\", [username, email, passwrd, secretkey, phoneNum, city, gender, DOB, userType, userID], function (err) {\n            if (!err) {\n                res.json('success');\n            } else {\n                res.json('fail');\n            }\n        });\n        connection.release();\n    });\n});\n\nrouter.post('/CompanyDetails', function(req, res) {\n    let companyID = req.body.companyID;\n    let companyName = req.body.companyName;\n    let ownerName = req.body.ownerName;\n    let yearEst = req.body.yearEst;\n    let companyNum = req.body.companyNum;\n    let companyEmail = req.body.companyEmail;\n    let description = req.body.description;\n    let address = req.body.address;\n    let latitude = req.body.latitude;\n    let longitude = req.body.longitude;\n    let monday = req.body.monday;\n    let tuesday = req.body.tuesday;\n    let wednesday = req.body.wednesday;\n    let thursday = req.body.thursday;\n    let friday = req.body.friday;\n    let saturday = req.body.saturday;\n    let sunday = req.body.sunday;\n\n    console.log(req.body);\n\n    pool.getConnection(function(err, connection) {\n        connection.query(\"UPDATE Business SET companyName = ?, ownerName = ?, yearEst = ?, companyNum = ?, companyEmail = ?, description = ?, address = ?, latitude = ?, longitude = ? WHERE businessID = ?\", [companyName, ownerName, yearEst, companyNum, companyEmail, description, address, latitude, longitude, companyID], function (err) {\n            if (!err) {\n                connection.query(\"UPDATE OpenHours SET monday = ?, tuesday = ?, wednesday = ?, thursday = ?, friday = ?, saturday = ?, sunday = ? WHERE businessID = ?\", [monday, tuesday, wednesday, thursday, friday, saturday, sunday, companyID], function (err) {\n                    if (!err) {\n                        res.json('success');\n                    }else {\n                        res.json('fail');\n                    }\n                });\n            }else {\n                res.json('fail');\n            }\n        });\n        connection.release();\n    });\n});\n\nmodule.exports = router;"]}